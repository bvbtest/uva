<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>JSON Test</title>
</head>
<body>

<div id="myData"></div>
<style type="text/css">
    #result {
        display:block;
        width:400px;
        height:200px;
    }

    #import {
        margin:10px 0;
    }
</style>
<script>
    const readFileAsText = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = ({ target }) => {
            resolve(target.result);
        };
        reader.readAsText(file);
    });

    const sendJSON = async json => {
        const headers = {
            'Content-Type': 'application/json'
        };

        const response = fetch('localhost:8080/api/v1/awesome/', {
            headers,
            method: 'POST',
            body: json
        });

        if (!response.ok) {
            throw new Error(`Sending file caused an error - ${response.statusText}`);
        }

        return response.json();
    };

    const form = document.querySelector('#upload-form');

    form.addEventListener('submit', async event => {
        event.preventDefault();

        const formData = new FormData(event.target);
        const file = formData.get('file');

        // No file size means no file.
        if (file.size === 0) {
            return; // Do nothing.
        }

        try {
            const json = document.querySelector('#file');
            console.log(json);
            const response = sendJSON(json);
            console.log(response);
        } catch (error) {
            console.log(error);
        }
    });


</script>

<form id="upload-form" action="http://localhost:8080/api/v1/awesome" method="POST" enctype="multipart/form-data">
    <input type="file" name="file" />
    <input type="submit"/>
</form>


<textarea id="result">
</textarea>
</body>
</html>

